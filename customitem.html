<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Address Form</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>

  <div class="container mt-4">
    <div class="row">
      <div class="col-md-6">
        <h2>User Address Form</h2>
        <form id="addressForm" method="post">
          <div class="form-group">
            <label for="province">Select Province:</label>
            <select id="province" name="province" class="form-control">
              <!-- Options will be populated dynamically using JavaScript -->
            </select>
          </div>
          <div class="form-group">
            <label for="district">Select District:</label>
            <select id="district" name="district" class="form-control">
              <!-- Options will be populated dynamically using JavaScript -->
            </select>
          </div>
          <div class="form-group">
            <label for="ward">Select Ward:</label>
            <select name="ward" id="ward" class="form-control">
              <!-- Options will be populated dynamically using JavaScript -->
            </select>
          </div>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>

      <div class="col-md-6">
        <h2>Shop Address Form</h2>
        <form id="shopAddressForm" action="" method="post">
          <div class="form-group">
            <label for="province_shop">Select Province:</label>
            <select name="province" id="province_shop" class="form-control">
              <!-- Options will be populated dynamically using JavaScript -->
            </select>
          </div>
          <div class="form-group">
            <label for="district_shop">Select District:</label>
            <select name="district" id="district_shop" class="form-control">
              <!-- Options will be populated dynamically using JavaScript -->
            </select>
          </div>
          <div class="form-group">
            <label for="ward_shop">Select Ward:</label>
            <select name="ward" id="ward_shop" class="form-control">
              <!-- Options will be populated dynamically using JavaScript -->
            </select>
          </div>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>
    </div>
  </div>

  <script>

    const token = "78710080-9b5f-11ee-b394-8ac29577e80e";
  
    async function fetchData(url, options) {
      try {
        const response = await fetch(url, options);
  
        if (!response.ok) {
          throw new Error('Error fetching data from API');
        }
  
        return await response.json();
      } catch (error) {
        throw new Error(error.message);
      }
    }
  
    async function getAddressFromApi(token) {
      const url = "https://online-gateway.ghn.vn/shiip/public-api/master-data/province";
      const options = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Token': token
        }
      };
  
      try {
        const data = await fetchData(url, options);
        populateProvinces(data.data);
      } catch (error) {
        console.error(error);
      }
    }
  
    function populateProvinces(provinces) {
      const provinceSelect = document.getElementById("province");
      provinces.forEach(province => {
        const option = document.createElement("option");
        option.value = province.ProvinceID;
        option.textContent = province.ProvinceName;
        provinceSelect.appendChild(option);
      });
  
      provinceSelect.addEventListener("change", function () {
        const selectedProvinceId = this.value;
        getDistrictsFromApi(token, selectedProvinceId);
      });
    }

  
    async function getDistrictsFromApi(token, provinceId) {
      const url = `https://online-gateway.ghn.vn/shiip/public-api/master-data/district?province_id=${provinceId}`;
      const options = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Token': token
        }
      };
  
      try {
        const data = await fetchData(url, options);
        populateDistricts(data.data);
      } catch (error) {
        console.error(error);
      }
    }
  
    function populateDistricts(districts) {
      const districtSelect = document.getElementById("district");
      districtSelect.innerHTML = '';
      districts.forEach(district => {
        const option = document.createElement("option");
        option.value = district.DistrictID;
        option.textContent = district.DistrictName;
        districtSelect.appendChild(option);
      });
  
      districtSelect.addEventListener("change", function () {
        const selectedDistrictId = this.value;
        getWardFromApi(token, selectedDistrictId);
      });
    }
  
    async function getWardFromApi(token, districtId) {
      const url = `https://online-gateway.ghn.vn/shiip/public-api/master-data/ward?district_id=${districtId}`;
      const options = {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          'Token': token
        }
      };
  
      try {
        const data = await fetchData(url, options);
        populateWards(data.data);
      } catch (error) {
        console.error(error);
      }
    }
  
    function populateWards(wards) {
      const wardSelect = document.getElementById("ward");
      wardSelect.innerHTML = '';
      wards.forEach(ward => {
        const option = document.createElement("option");
        option.value = ward.WardId;
        option.textContent = ward.WardName;
        wardSelect.appendChild(option);
      });
    }
  
    getAddressFromApi(token)
      .then(() => {
        console.log("API call successful");
      })
      .catch((error) => {
        console.error("Error:", error);
      });
  
  </script>
  

</body>
</html>
